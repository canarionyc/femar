# https://www.census.gov/topics/housing.html

rhfs_fst <- file.path(the$CENSUS_WORKDIR, "rhfspuf2021_v1_1.fst"); print(file.info(rhfs_fst))
if(file.exists(rhfs_fst)) {
  print(fst.metadata(rhfs_fst))
  rhfs <- read_fst(rhfs_fst, as.data.table = TRUE)
} else {


rhfs <- read_csv("E:/Datasets/Census/RHFS/rhfspuf2021_v1_1.csv", col_types = cols(
  NUMUNITS_R = col_double(),
  OUTCOME = col_character(),
  SAMPSTRATA = col_character(),
  ACCEPT = col_double(),
  ADAGENCY = col_double(),
  ADAGENT = col_double(),
  ADNEWSPAPER = col_double(),
  ADONLINE = col_double(),
  ADOTHONLINE = col_double(),
  ADVERTISE = col_double(),
  ADWEBSITE = col_double(),
  BENEOTH = col_double(),
  BROOMS = col_double(),
  UNITSTAT = col_double(),
  CASHDWN = col_double(),
  CASHDWNAMT = col_double(),
  COMMRENT = col_double(),
  COMMSPACE = col_double(),
  CONCSS = col_double(),
  CONCSSNUM = col_double(),
  CPACCAMT = col_double(),
  CPBATAMT = col_double(),
  CPDOORAMT = col_double(),
  CPELEAMT = col_double(),
  CPEXTAMT = col_double(),
  CPFLRAMT = col_double(),
  CPHEATAMT = col_double(),
  CPKITAMT = col_double(),
  CPOTHAMT = col_double(),
  CPPLBAMT = col_double(),
  CPRESAMT_R = col_double(),
  CPRFAMT = col_double(),
  CPWINAMT = col_double(),
  DEBT = col_double(),
  DEBT1 = col_double(),
  DEBTNUM = col_double(),
  ECONDEVLP = col_double(),
  ELDERLY = col_double(),
  GOVBELOW = col_double(),
  GOVGRANT = col_double(),
  HIRENT = col_double(),
  HISTORIC = col_double(),
  HOWACQ = col_double(),
  HOWMVAL = col_double(),
  HRSMNGMNT = col_double(),
  ICABLE = col_double(),
  IELEC = col_double(),
  IGAS = col_double(),
  IPARKING = col_double(),
  IPOOL = col_double(),
  ISEWER = col_double(),
  IWATER = col_double(),
  IWIFI = col_double(),
  LEASLNG = col_double(),
  LOCTYP = col_double(),
  LOWINAREA = col_double(),
  LOWINCTEN = col_double(),
  LOWRENT = col_double(),
  MLS = col_double(),
  MNGMNT = col_double(),
  MORTAMT = col_double(),
  MORTGET = col_double(),
  MRKTVAL_R = col_double(),
  OFFSTPARK = col_double(),
  OFFSTPARKAHS = col_double(),
  OPELGAS = col_double(),
  OPINSUR = col_double(),
  OPLAND = col_double(),
  OPMNG = col_double(),
  OPOTHEX = col_double(),
  OPPAY = col_double(),
  OPREP = col_double(),
  OPPROTH = col_double(),
  OPSECUR = col_double(),
  OPWTRSWR = col_double(),
  OTHRCV = col_double(),
  OUTBAL = col_double(),
  OWNENT = col_double(),
  PMTFREQ = col_double(),
  PROPANS = col_double(),
  PROPTOWN = col_double(),
  RCONTROL = col_double(),
  RCONTROLAHS = col_double(),
  RECCOMMREN = col_double(),
  REGPAY = col_double(),
  RENT = col_double(),
  RPIPMI = col_double(),
  RPIPRIN = col_double(),
  RPIPRPINS = col_double(),
  RPIPRPTAX = col_double(),
  RSUBSIDY = col_double(),
  SENIOR = col_double(),
  STLOWINC = col_double(),
  BED0_R = col_double(),
  BED1_R = col_double(),
  BED2_R = col_double(),
  BED3_R = col_double(),
  TOTCOLL = col_double(),
  TOTRENTVAC = col_double(),
  WEEKLNG = col_double(),
  WEEKLNGNUM = col_double(),
  WEEKLNGPCT = col_double(),
  WHYNOMRT = col_double(),
  SURVYR = col_double(),
  CONTROLPUF = col_double(),
  NUMBLD_R = col_double(),
  JRNEWBLG = col_double(),
  JOWACQ = col_double(),
  JRPROPACQ = col_double(),
  JURPRICE = col_double(),
  JASHDWN = col_double(),
  JASHDWNAMT = col_double(),
  JRKTVAL = col_double(),
  JOWMVAL = col_double(),
  JBROOMS = col_double(),
  JOWRENT = col_double(),
  JIRENT = col_double(),
  JOTRENTVAC = col_double(),
  JENT = col_double(),
  JNITSTAT = col_double(),
  MRKTVALPU_R = col_double(),
  PURPRICE_R = col_double(),
  JONCSS = col_double(),
  JONCSSNUM = col_double(),
  JENIOR = col_double(),
  JCONTROL = col_double(),
  JCONTROLAHS = col_double(),
  JFFSTPARK = col_double(),
  JFFSTPARKAHS = col_double(),
  JELEC = col_double(),
  JGAS = col_double(),
  JWATER = col_double(),
  JSEWER = col_double(),
  JCABLE = col_double(),
  JWIFI = col_double(),
  JPOOL = col_double(),
  JPARKING = col_double(),
  JROPANS = col_double(),
  JOTCOLL = col_double(),
  JOMMSPACE = col_double(),
  JECCOMMREN = col_double(),
  JOMMRENT = col_double(),
  JNGMNT = col_double(),
  JRSMNGMNT = col_double(),
  MRENTRCTS_R = col_double(),
  TRENTRCTPV_R = col_double(),
  JWNENT = col_double(),
  JOVBELOW = col_double(),
  JSUBSIDY = col_double(),
  JLDERLY = col_double(),
  JOVGRANT = col_double(),
  JENEOTH = col_double(),
  JISTORIC = col_double(),
  JOWINCTEN = col_double(),
  JOWINAREA = col_double(),
  JCONDEVLP = col_double(),
  JTHRCV = col_double(),
  JTLOWINC = col_double(),
  HUDUNITS = col_double(),
  OPEX_R = col_double(),
  OPEXPU_R = col_double(),
  JPPAY = col_double(),
  JPREP = col_double(),
  JPSECUR = col_double(),
  JPTAX = col_double(),
  JPWTRSWR = col_double(),
  JPOTHEXP = col_double(),
  JPINSUR = col_double(),
  JPROTH = col_double(),
  JPLAND = col_double(),
  JPMNG = col_double(),
  JPELGAS = col_double(),
  CAPEX_R = col_double(),
  CAPEXPU_R = col_double(),
  JPACCAMT = col_double(),
  JPBATAMT = col_double(),
  JPDOORAMT = col_double(),
  JPELEAMT = col_double(),
  JPEXTAMT = col_double(),
  JPFLRAMT = col_double(),
  JPHEATAMT = col_double(),
  JPKITAMT = col_double(),
  JPOTHAMT = col_double(),
  JPPLBAMT = col_double(),
  JPRFAMT = col_double(),
  JPWINAMT = col_double(),
  JPRESAMT = col_double(),
  JEBT = col_double(),
  JHYNOMRT = col_double(),
  JEBTNUM = col_double(),
  JEBT1 = col_double(),
  JORTAMT = col_double(),
  JUTBAL = col_double(),
  JNCRDTAMT = col_double(),
  JPPVAL = col_double(),
  JORTGET = col_double(),
  JOCTYP1 = col_double(),
  JEGPAY = col_double(),
  JMTAMT = col_double(),
  JMTFREQ = col_double(),
  JPIPRIN = col_double(),
  JPIPRPINS = col_double(),
  JPIPMI = col_double(),
  JPIPRPTAX = col_double(),
  JRMORT = col_double(),
  TRENOC_R = col_double(),
  TRENVA_R = col_double(),
  TOWNOC_R = col_double(),
  TEMPOC_R = col_double(),
  TOTHVA_R = col_double(),
  JRENOC_R = col_double(),
  JRENVA_R = col_double(),
  JOWNOC_R = col_double(),
  JEMPOC_R = col_double(),
  JOTHVA_R = col_double(),
  RENT1099_R = col_double(),
  RENT1249_R = col_double(),
  RENT1499_R = col_double(),
  RENT1999_R = col_double(),
  RENT2499_R = col_double(),
  RENT274_R = col_double(),
  RENT299_R = col_double(),
  RENT2999_R = col_double(),
  RENT349_R = col_double(),
  RENT3499_R = col_double(),
  RENT399_R = col_double(),
  RENT3999_R = col_double(),
  RENT449_R = col_double(),
  RENT4499_R = col_double(),
  RENT499_R = col_double(),
  RENT4999_R = col_double(),
  RENT5000_R = col_double(),
  RENT549_R = col_double(),
  RENT599_R = col_double(),
  RENT649_R = col_double(),
  RENT699_R = col_double(),
  RENT749_R = col_double(),
  RENT799_R = col_double(),
  RENT899_R = col_double(),
  RENT999_R = col_double(),
  RENTLT249_R = col_double(),
  RENTNO_R = col_double(),
  JEASLNG = col_double(),
  JEEKLNG = col_double(),
  JEEKLNGNUM = col_double(),
  JEEKLNGPCT = col_double(),
  JDVERTISE = col_double(),
  JDWEBSITE = col_double(),
  JDONLINE = col_double(),
  JDOTHONLINE = col_double(),
  JDNEWSPAPER = col_double(),
  JDAGENCY = col_double(),
  JDAGENT = col_double(),
  JLS = col_double(),
  JROPTOWN = col_double(),
  JCCEPT = col_double(),
  LIHTCUNITS = col_double(),
  REPWGT1 = col_double(),
  WEIGHT = col_double(),
  REPWGT2 = col_double(),
  REPWGT3 = col_double(),
  REPWGT4 = col_double(),
  REPWGT5 = col_double(),
  REPWGT6 = col_double(),
  REPWGT7 = col_double(),
  REPWGT8 = col_double(),
  REPWGT9 = col_double(),
  REPWGT10 = col_double(),
  REPWGT11 = col_double(),
  REPWGT12 = col_double(),
  REPWGT13 = col_double(),
  REPWGT14 = col_double(),
  REPWGT15 = col_double(),
  REPWGT16 = col_double(),
  REPWGT17 = col_double(),
  REPWGT18 = col_double(),
  REPWGT19 = col_double(),
  REPWGT20 = col_double(),
  REPWGT21 = col_double(),
  REPWGT22 = col_double(),
  REPWGT23 = col_double(),
  REPWGT24 = col_double(),
  REPWGT25 = col_double(),
  REPWGT26 = col_double(),
  REPWGT27 = col_double(),
  REPWGT28 = col_double(),
  REPWGT29 = col_double(),
  REPWGT30 = col_double(),
  REPWGT31 = col_double(),
  REPWGT32 = col_double(),
  REPWGT33 = col_double(),
  REPWGT34 = col_double(),
  REPWGT35 = col_double(),
  REPWGT36 = col_double(),
  REPWGT37 = col_double(),
  REPWGT38 = col_double(),
  REPWGT39 = col_double(),
  REPWGT40 = col_double(),
  REPWGT41 = col_double(),
  REPWGT42 = col_double(),
  REPWGT43 = col_double(),
  REPWGT44 = col_double(),
  REPWGT45 = col_double(),
  REPWGT46 = col_double(),
  REPWGT47 = col_double(),
  REPWGT48 = col_double(),
  REPWGT49 = col_double(),
  REPWGT50 = col_double(),
  REPWGT51 = col_double(),
  REPWGT52 = col_double(),
  REPWGT53 = col_double(),
  REPWGT54 = col_double(),
  REPWGT55 = col_double(),
  REPWGT56 = col_double(),
  REPWGT57 = col_double(),
  REPWGT58 = col_double(),
  REPWGT59 = col_double(),
  REPWGT60 = col_double(),
  REPWGT61 = col_double(),
  REPWGT62 = col_double(),
  REPWGT63 = col_double(),
  REPWGT64 = col_double(),
  REPWGT65 = col_double(),
  REPWGT66 = col_double(),
  REPWGT67 = col_double(),
  REPWGT68 = col_double(),
  REPWGT69 = col_double(),
  REPWGT70 = col_double(),
  REPWGT71 = col_double(),
  REPWGT72 = col_double(),
  REPWGT73 = col_double(),
  REPWGT74 = col_double(),
  REPWGT75 = col_double(),
  REPWGT76 = col_double(),
  REPWGT77 = col_double(),
  REPWGT78 = col_double(),
  REPWGT79 = col_double(),
  REPWGT80 = col_double(),
  REPWGT81 = col_double(),
  REPWGT82 = col_double(),
  REPWGT83 = col_double(),
  REPWGT84 = col_double(),
  REPWGT85 = col_double(),
  REPWGT86 = col_double(),
  REPWGT87 = col_double(),
  REPWGT88 = col_double(),
  REPWGT89 = col_double(),
  REPWGT90 = col_double(),
  REPWGT91 = col_double(),
  REPWGT92 = col_double(),
  REPWGT93 = col_double(),
  REPWGT94 = col_double(),
  REPWGT95 = col_double(),
  REPWGT96 = col_double(),
  REPWGT97 = col_double(),
  REPWGT98 = col_double(),
  REPWGT99 = col_double(),
  REPWGT100 = col_double(),
  NUMCAT_R = col_character(),
  YRNEWBLG_R = col_double(),
  YRPROPACQ_R = col_double(),
  YRMORT_R = col_double(),
  OPTAX_R = col_double(),
  APPVAL_R = col_double(),
  CAPRATE_R = col_double(),
  MORTAMT_R = col_double(),
  OUTBAL_R = col_double(),
  PMTAMT_R = col_double(),
  LNCRDTAMT_R = col_double()
))
str(rhfs, give.attr=FALSE)
rhfs <- as.data.table(rhfs)
print(dim(rhfs))
write_fst(rhfs, path = rhfs_fst);   print(file.info(rhfs_fst))
}; str(rhfs)
rhfs

(weights <- rhfs[, REPWGT1:REPWGT100])
